/* [0] 화면 제어 */
.screen { display: none !important; padding: 20px 10px 80px 10px; text-align: center; animation: fadeIn 0.3s; }
.screen.active { display: block !important; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* [1] 전역 설정 */
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&display=swap');
:root { --soop-blue:#00adef; --bg-color:#f5f7fa; --card-bg:#2b2b2b; --text-color:#333; --modal-bg:white; --tab-bg:#e0e0e0; --new-gold:rgba(255,215,0,1.0); }
body { margin:0; padding:70px 0 50px 0; font-family:'Noto Sans KR', sans-serif; background:var(--bg-color); color:var(--text-color); user-select:none; -webkit-user-select:none; letter-spacing:-0.5px; overflow-x:hidden; }

/* 다크모드 */
body.dark-mode { --soop-blue:#34bbf3; --bg-color:#1a1a1a; --card-bg:#333; --text-color:#f0f0f0; --modal-bg:#2a2a2a; --tab-bg:#333; }
body.dark-mode .notice-box, body.dark-mode .modal-content, body.dark-mode .crew-book-header, body.dark-mode .top-bar, body.dark-mode .menu-btn, body.dark-mode .game-container, body.dark-mode .game-card-list-area, body.dark-mode .crew-book-body { background:#2a2a2a; border-color:#444; color:#f0f0f0; }
body.dark-mode .tab-btn.active { background:#555; color:white; }
body.dark-mode .top-bar { border-bottom:1px solid #333; }
body.dark-mode input, body.dark-mode select { background:#333; color:white; border-color:#555; }
body.dark-mode .achievement-item.claimed { background: #222 !important; color: #777; }
body.dark-mode .stats-box { background: #333; border: 1px solid #555; }
body.dark-mode .crew-name-input { color: white; border-bottom: 2px solid #555; }
body.dark-mode .game-rules-box { background: #333; border-color: #555; color: #ccc; }

/* [2] 상단바 및 로고 */
.top-bar { position:fixed; top:0; left:0; width:100%; height:60px; background:white; border-bottom:1px solid #ddd; display:flex; justify-content:space-between; align-items:center; padding:0 15px; box-sizing:border-box; z-index:1000; }
.home-btn-area { font-size:24px; cursor:pointer; width: 80px; text-align: left; } 
.logo-area { position: absolute; left: 50%; transform: translateX(-50%); cursor:pointer; display:flex; justify-content:center; }
.currency-group { display:flex; gap:8px; width: auto; justify-content: flex-end; }
.coin-area { font-size:13px; font-weight:700; color:#333; background:#fff8e1; padding:4px 8px; border-radius:15px; border:1px solid #f1c40f; display:flex; align-items:center; gap:4px; white-space:nowrap; }
.bp-area { background:#e3f2fd; border:1px solid #64b5f6; }

/* [수정] 코인 아이콘 스타일 */
.currency-icon { width: 24px; height: 24px; margin-right: 5px; object-fit: contain; }

.soop-text-logo {
    font-family: 'Noto Sans KR', sans-serif; font-weight: 900; color: var(--soop-blue);
    line-height: 1; letter-spacing: -1px;
}

/* [3] 메뉴 */
.main-logo { margin:20px 0 30px 0; text-align:center; } 
.menu-grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; padding:0 20px; max-width:480px; margin:0 auto 30px auto; }
.menu-btn { width:100%; padding:15px 10px; font-size:16px; font-weight:700; border:none; border-radius:15px; background:white; box-shadow:0 4px 0 #ddd; cursor:pointer; display:flex; flex-direction:column; align-items:center; justify-content:center; min-height:80px; color:#333; transition:transform 0.1s; }
.menu-btn:active { transform:translateY(4px); box-shadow:none; }
.menu-btn.primary { background:var(--soop-blue); color:white; box-shadow:0 4px 0 #007bb5; font-size:18px; }
.menu-btn.sub { background:#95a5a6; color:white; box-shadow:0 4px 0 #7f8c8d; font-size:14px; min-height:60px; }

/* [4] 카드 */
.card-grid { display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin-top:20px; }
.card-wrapper { position:relative; width:120px; cursor:pointer; transition:transform 0.2s; display:flex; flex-direction:column; align-items:center; }
.card-wrapper:hover { transform:scale(1.05); z-index:10; }
.card-item { width:120px; height:160px; clip-path:polygon(15% 0%, 85% 0%, 100% 15%, 100% 75%, 50% 100%, 0% 75%, 0% 15%); padding:4px; box-sizing:border-box; position:relative; z-index:1; }
.card-item.star-1 { background:#3498db; } .card-item.star-2 { background:#e74c3c; } .card-item.star-3 { background:#9b59b6; } .card-item.star-4 { background:#f1c40f; }
.card-item.star-5, .card-item.star-22 { background:transparent; }
.card-item.star-5::before, .card-item.star-22::before { content:""; position:absolute; top:0; left:0; right:0; bottom:0; background:linear-gradient(135deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #8b00ff); background-size:200% 200%; animation:rainbowMove 2s linear infinite; z-index:-1; }
@keyframes rainbowMove { 0% {background-position:0% 50%;} 50% {background-position:100% 50%;} 100% {background-position:0% 50%;} }
.card-item.locked { background:#444; }
.card-inner { width:100%; height:100%; background:var(--card-bg); clip-path:polygon(15% 0%, 85% 0%, 100% 15%, 100% 75%, 50% 100%, 0% 75%, 0% 15%); display:flex; justify-content:center; align-items:center; position:relative; overflow:hidden; }
.card-img { width:200%; height:200%; object-fit:cover; object-position:bottom center; position:absolute; top:0; left:0; transform:scale(0.5); transform-origin:0 0; border-radius:20px; image-rendering:auto; filter:blur(0.2px); backface-visibility:hidden; will-change:transform; }
.card-txt { position:absolute; color:white; font-family:'Noto Sans KR', sans-serif; font-weight:900; z-index:10; pointer-events:none; text-shadow:-1.5px -1.5px 0 #000, 1.5px -1.5px 0 #000, -1.5px 1.5px 0 #000, 1.5px 1.5px 0 #000; }
.card-star { top:6px; left:20px; font-size:16px; color:#ffd700; }
.card-name { bottom:28px; left:0; width:100%; padding:0 4px; box-sizing:border-box; text-align:center; font-size:14px; letter-spacing:-0.5px; display:-webkit-box; -webkit-line-clamp:2; line-clamp:2; -webkit-box-orient:vertical; overflow:hidden; word-break:keep-all; line-height:1.1; justify-content:center; }

.card-item.large { width:240px; height:320px; padding:6px; clip-path:polygon(15% 0%, 85% 0%, 100% 15%, 100% 75%, 50% 100%, 0% 75%, 0% 15%); } 
.card-item.large .card-inner { clip-path:polygon(15% 0%, 85% 0%, 100% 15%, 100% 75%, 50% 100%, 0% 75%, 0% 15%); border-radius:0; }
.card-wrapper.large { width:240px; height:320px; margin:25px auto; }
.card-wrapper.large .card-img { transform:scale(0.5); }
.card-item.large .card-star { top:20px; left:25px; font-size:24px; text-shadow:2px 2px 4px rgba(0,0,0,0.8); }
.card-item.large .card-name { bottom:40px; left:0; width:100%; font-size:28px; line-height:1.2; padding:0 10px; text-shadow:2px 2px 4px rgba(0,0,0,0.8); }

/* [5] 나만의 크루 */
.crew-header-container { display: flex; flex-direction: column; align-items: center; justify-content: center; margin-bottom: 10px; }
.crew-logo-display { width: 90px; height: 90px; border-radius: 50%; background: white; box-shadow: 0 4px 10px rgba(0,0,0,0.2); overflow: hidden; display: flex; justify-content: center; align-items: center; cursor: pointer; margin-bottom: 10px; transition: transform 0.2s; }
.crew-logo-display:hover { transform: scale(1.05); }
.crew-logo-display img { width: 100%; height: 100%; object-fit: cover; }
.crew-name-input { font-size: 20px; font-weight: 800; text-align: center; border: none; border-bottom: 2px solid #ddd; background: transparent; color: #333; padding: 5px; margin-bottom: 10px; width: 200px; }
.crew-name-input:focus { outline: none; border-color: var(--soop-blue); }
.crew-control-panel { display: flex; justify-content: center; gap: 15px; margin-bottom: 10px; }
.control-item { display: flex; align-items: center; gap: 5px; font-size: 14px; font-weight: 700; color: #555; }
.formation-btn { padding: 6px 12px; border: 1px solid #ccc; background: white; border-radius: 15px; font-size: 13px; font-weight: bold; color: #555; cursor: pointer; transition: all 0.2s; }
.formation-btn:hover { background: #f0f0f0; }
.formation-btn.active { background: var(--soop-blue); color: white; border-color: var(--soop-blue); }
.crew-palette { display: flex; gap: 8px; flex-wrap: wrap; justify-content: center; margin-top: 5px; }
.color-swatch { width: 24px; height: 24px; border-radius: 50%; cursor: pointer; border: 1px solid rgba(0,0,0,0.1); transition: transform 0.1s, box-shadow 0.1s; }
.color-swatch:hover { transform: scale(1.2); box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
.crew-bg-container { background: white; border-radius: 25px; padding: 20px 10px; margin: 15px auto; width: 95%; max-width: 600px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: background-color 0.3s; }
.my-crew-slots { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin: 20px 0; }
.crew-row { display: flex; justify-content: center; gap: 10px; width: 100%; flex-wrap: nowrap; margin-bottom: 10px;}
.slot { width:120px; height:160px; display:flex; align-items:center; justify-content:center; cursor:pointer; position: relative; }
.slot.empty { background:rgba(200,200,200,0.5); clip-path:polygon(15% 0%, 85% 0%, 100% 15%, 100% 75%, 50% 100%, 0% 75%, 0% 15%); color:#999; font-size:32px; font-weight:bold; }
.slot-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); clip-path: polygon(15% 0%, 85% 0%, 100% 15%, 100% 75%, 50% 100%, 0% 75%, 0% 15%); display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 10px; opacity: 0; transition: opacity 0.2s; z-index: 20; }
.slot:hover .slot-overlay { opacity: 1; }
.overlay-btn { background: white; border: none; padding: 5px 10px; border-radius: 15px; font-size: 12px; font-weight: 700; cursor: pointer; width: 80px; }
.overlay-btn:hover { background: #eee; }
.overlay-btn.red { color: #e74c3c; }

/* [6] 미니게임 & 전체화면 게임 */
.game-container { text-align:center; background:var(--modal-bg); padding:20px; border-radius:15px; max-width:650px; width: 95%; margin:0 auto; box-shadow:0 5px 15px rgba(0,0,0,0.1); }
#game-lobby { display: block; }
#game-play-area.pc-mode-active {
    display: none; position: relative; width: 100%; max-width: 800px; height: 400px; margin: 20px auto;
    background: #f0f0f0; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); overflow: hidden; z-index: 100;
}
#game-play-area.pc-mode-active #game-canvas { width: 100%; height: 100%; object-fit: contain; }
#game-play-area.mobile-mode-active {
    display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
    background: #f0f0f0; z-index: 5000; flex-direction: column; justify-content: center; align-items: center;
}
#game-play-area.mobile-mode-active #game-canvas { width: 100%; height: 100%; object-fit: contain; }
.mode-btn { padding: 8px 16px; border: 2px solid #ddd; background: white; border-radius: 20px; font-weight: bold; color: #555; cursor: pointer; margin: 0 5px; }
.mode-btn.active { border-color: var(--soop-blue); background: #e3f2fd; color: var(--soop-blue); }
#orientation-lock { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 9999; color: white; justify-content: center; align-items: center; text-align: center; }
@media screen and (orientation: portrait) { body.game-active #orientation-lock { display: flex; } }
.game-char-select { display:flex; align-items:center; gap:15px; padding:15px; border:2px solid #ddd; border-radius:15px; margin-bottom:20px; cursor:pointer; background:rgba(0,0,0,0.02); justify-content: center; }
.selected-char-preview { width:60px; height:60px; border-radius:50%; background:#eee; overflow:hidden; display:flex; justify-content:center; align-items:center; border:2px solid var(--soop-blue); flex-shrink:0; }
.selected-char-preview img { width:100%; height:100%; object-fit:cover; }
.game-card-list-area { background:var(--modal-bg); border:1px solid #ddd; border-radius:10px; padding:10px; margin-bottom:15px; max-height:200px; overflow-y:auto; }
.game-score-board { margin: 15px 0; font-size: 20px; font-weight: bold; }
.game-hud { position: absolute; top: 10px; left: 10px; right: 10px; display: flex; justify-content: space-between; font-size: 20px; font-weight: bold; color: #333; text-shadow: 1px 1px 0 #fff; pointer-events: none; }
.hud-item { background: rgba(255,255,255,0.7); padding: 5px 10px; border-radius: 10px; }
.hud-quit-btn { pointer-events: auto; background: #e74c3c; color: white; border: none; padding: 5px 15px; border-radius: 10px; font-weight: bold; cursor: pointer; }
.game-rules-box { background: #f9f9f9; padding: 15px; border-radius: 10px; border: 1px solid #eee; margin-bottom: 20px; }

/* 기타 UI */
.notice-box { margin:20px auto; width:fit-content; max-width:95%; min-width:300px; background:#fff; border:2px solid #eee; border-radius:15px; padding:20px; text-align:left; box-shadow:0 5px 15px rgba(0,0,0,0.05); }
.notice-box h3 { margin:0 0 10px 0; font-size:18px; color:var(--soop-blue); border-bottom:1px solid #f0f0f0; padding-bottom:10px; text-align:center; }
.center-header { justify-content: center !important; }
.tab-menu { display:flex; justify-content:center; gap:5px; margin-bottom:20px; background:var(--tab-bg); padding:5px; border-radius:30px; width:fit-content; margin-left:auto; margin-right:auto; }
.tab-btn { padding:8px 25px; border:none; background:transparent; border-radius:25px; cursor:pointer; font-size:15px; font-weight:700; color:#888; transition:all 0.2s; }
.tab-btn.active { background:white; color:var(--soop-blue); box-shadow:0 2px 5px rgba(0,0,0,0.1); }
.achieve-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:15px; padding:0 5px; width:100%; box-sizing:border-box; }
.controls-area { width:100%; display:flex; flex-direction:column; gap:8px; margin-bottom:15px; align-items:center; }
.filter-row { display:flex; gap:5px; width:90%; justify-content:center; }
.controls-area input, .controls-area select { padding:10px; border:1px solid #ccc; border-radius:15px; font-family:'Noto Sans KR', sans-serif; font-size:15px; font-weight:500; box-sizing:border-box; width:90%; text-align:center; }
.controls-area select { width:50%; }
.achievement-item { border-bottom:1px solid #eee; padding:15px; display:flex; justify-content:space-between; align-items:center; transition: 0.3s; }
.crew-book-header { display:flex; align-items:center; gap:10px; padding:12px; margin-top:10px; border-radius:15px; border:1px solid #ddd; cursor:pointer; background:#fff; transition:all 0.2s; }
.crew-book-header:hover { background:#f9f9f9; } 
.crew-book-header.completed { background: #e1f5fe; border: 2px solid var(--soop-blue); }
.crew-book-logo { width:36px; height:36px; border-radius:8px; border:1px solid #ddd; object-fit:contain; background-color:white; }
.crew-book-title { font-size:16px; font-weight:700; flex-grow:1; display:flex; justify-content:flex-start; align-items:center; gap: 5px; } 
.crew-count { font-size:13px; color:#666; font-weight:500; margin-left: auto; }
.crew-book-body { display:none; background:white; border:1px solid #eee; padding:15px; flex-wrap:wrap; justify-content:center; gap:10px; margin-bottom:15px; border-radius:0 0 15px 15px; }
.crew-book-body.active { display:flex; }
.shop-buy-btn { margin-top:8px; padding:8px 0; width:100%; background:white; border:2px solid var(--soop-blue); border-radius:10px; color:var(--soop-blue); font-family:'Noto Sans KR', sans-serif; font-size:14px; font-weight:800; cursor:pointer; }
.shop-buy-btn:disabled { border-color:#aaa; color:#aaa; cursor:not-allowed; background:#eee; }
.soop-badge-btn { display:inline-flex; align-items:center; justify-content:center; gap:8px; background:white; border:2px solid var(--soop-blue); color:var(--soop-blue); border-radius:25px; padding:10px 20px; font-size:16px; font-weight:700; cursor:pointer; transition:all 0.2s; }
.soop-badge-btn:hover { background:#f0faff; } .soop-badge-btn img { height:24px; width:auto; }
.modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:2000; justify-content:center; align-items:center; }
.modal-content { background:var(--modal-bg); padding:25px; border-radius:25px; width:90%; max-width:500px; text-align:center; position:relative; max-height:90vh; overflow-y:auto; }
.close-btn-x { position:absolute; top:15px; right:20px; font-size:32px; background:none; border:none; cursor:pointer; color:#aaa; z-index:100; }
.close-btn { background:#95a5a6; color:white; padding:12px 35px; border:none; border-radius:25px; cursor:pointer; margin-top:15px; font-size:16px; font-weight:700; }
.action-btn { background:var(--soop-blue); color:white; padding:15px; border:none; border-radius:30px; font-size:20px; font-weight:800; cursor:pointer; width:100%; max-width:350px; box-shadow:0 5px 0 #007bb5; }
.action-btn.small { width:auto; padding:10px 20px; font-size:16px; border-radius:20px; }
.action-btn.green { background:#2ecc71; box-shadow:0 4px 0 #27ae60; width:auto; font-size:16px; padding:10px 20px; margin:0; }
.btn-blue, .btn-green, .btn-red { width:100%; padding:15px; border:none; border-radius:10px; margin-bottom:8px; cursor:pointer; color:white; font-size:16px; font-weight:700; }
.btn-blue { background:var(--soop-blue); } .btn-green { background:#2ecc71; } .btn-red { background:#e74c3c; }
.stats-box { background: #f9f9f9; border: 1px solid #eee; border-radius: 15px; padding: 15px; text-align: left; margin-bottom: 20px; }
.stats-box p { margin: 8px 0; font-size: 16px; color: #555; font-weight: 700; }
.gacha-promo-card { background:var(--modal-bg); border-radius:25px; padding:20px; margin:15px auto; max-width:400px; box-shadow:0 10px 25px rgba(0,0,0,0.1); text-align:center; }
.promo-banner img { width:100%; height:auto; border-radius:15px; box-shadow:0 4px 10px rgba(0,0,0,0.1); margin-bottom:15px; }
.new-badge { position:absolute; top:-2px; left:-4px; z-index:50; background:var(--new-gold); color:white; border:2px solid white; font-size:12px; font-weight:900; padding:2px 8px; border-radius:8px 0 8px 0; box-shadow:2px 2px 5px rgba(0,0,0,0.5); transform:rotate(-10deg); }
.flip-in { animation:flipEffect 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }
@keyframes flipEffect { 0% {transform:scale(0.8) rotateY(180deg); opacity:0;} 100% {transform:scale(1) rotateY(0deg); opacity:1;} }
.card-back-design { width:100%; height:100%; background:repeating-linear-gradient(45deg, #2a2a2a, #2a2a2a 10px, #333 10px, #333 20px); display:flex; justify-content:center; align-items:center; color:#777; font-size:32px; font-weight:bold; }
.fixed-email-footer { position:fixed; bottom:5px; left:0; width:100%; text-align:center; font-size:12px; color:#aaa; z-index:9999; pointer-events:none; font-family:sans-serif; }

/* [수정] 상점 버튼 그룹 */
.shop-btn-group { display: flex; gap: 5px; margin-top: 8px; width: 100%; }
.shop-buy-btn { padding: 6px 0; width: 100%; border-radius: 8px; font-size: 13px; font-weight: 800; cursor: pointer; background: white; }
.shop-buy-btn.coin { border: 2px solid var(--soop-blue); color: var(--soop-blue); }
.shop-buy-btn.ticket { border: 2px solid #64b5f6; color: #64b5f6; }

/* [수정] 진화 연출 */
.evolution-overlay { background: rgba(0,0,0,0.95) !important; display: none; flex-direction: column; z-index: 9999; justify-content: center; align-items: center; }
.evolution-content { position: relative; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 100%; height: 100%; }
.evo-buildup { animation: buildUpEffect 2s cubic-bezier(0.6, 0.04, 0.98, 0.335) forwards; }
@keyframes buildUpEffect {
    0% { transform: scale(1) rotate(0deg); filter: brightness(1); }
    10% { transform: scale(1.05) rotate(-2deg); }
    20% { transform: scale(1.05) rotate(2deg); }
    30% { transform: scale(1.1) rotate(-3deg); filter: brightness(1.2); }
    40% { transform: scale(1.1) rotate(3deg); }
    50% { transform: scale(1.15) rotate(-4deg); filter: brightness(1.5); box-shadow: 0 0 20px gold; }
    60% { transform: scale(1.15) rotate(4deg); }
    70% { transform: scale(1.2) rotate(-5deg); filter: brightness(2); }
    80% { transform: scale(1.25) rotate(5deg); }
    90% { transform: scale(1.3) rotate(-5deg); filter: brightness(3); opacity: 1; }
    100% { transform: scale(1.4) rotate(0deg); filter: brightness(5); opacity: 0; }
}
.evo-finish { animation: finishEffect 0.8s ease-out forwards; opacity: 0; }
@keyframes finishEffect {
    0% { transform: scale(1.5); filter: brightness(2); opacity: 0; }
    20% { opacity: 1; }
    50% { transform: scale(1); filter: brightness(1); }
    70% { transform: scale(1.05); }
    100% { transform: scale(1); }
}
.evo-flash-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white; opacity: 0; pointer-events: none; z-index: 1000; }
.flash-active { animation: whiteFlash 1.5s ease-out forwards; }
@keyframes whiteFlash { 0% { opacity: 0; } 50% { opacity: 1; } 100% { opacity: 0; } }
.evo-text { color: #ffd700; font-size: 40px; font-weight: 900; margin-top: 30px; text-shadow: 0 0 20px orange; opacity: 0; transform: translateY(20px); transition: all 0.5s; }
.evo-text.show { opacity: 1; transform: translateY(0); }

@media (max-width: 768px) { .menu-grid { grid-template-columns:1fr 1fr; } #gacha-result-grid { grid-template-columns:repeat(3, 1fr); gap:5px; } #gacha-result-grid .card-wrapper { width:100px; } #gacha-result-grid .card-item { width:100px; height:133px; } .crew-row .card-wrapper { width: 17vw; max-width: 90px; height: auto; } .crew-row .slot, .crew-row .card-item { width: 100%; height: 26vw; max-height: 120px; } .crew-row .slot.empty { font-size: 20px; } }
