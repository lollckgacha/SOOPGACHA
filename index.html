<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SOOP 버츄얼 가챠</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="orientation-lock">
        <div class="lock-content">
            <span style="font-size: 40px;">📱🔄</span>
            <p>원활한 플레이를 위해<br>화면을 <strong>가로로 회전</strong>해주세요.</p>
        </div>
    </div>

    <header class="top-bar">
        <div class="home-btn-area" onclick="goHome()"><span>🏠</span></div>
        <div class="logo-area" onclick="goHome()">
            <span class="soop-text-logo" style="font-size: 24px;">SOOP</span>
        </div>
        <div class="currency-group">
            <div class="coin-area">
                <div class="soop-coin">S</div>
                <span id="user-coin">0</span>
            </div>
            <div class="coin-area bp-area">
                <img src="images/bp.webp" class="coin-icon" alt="B" onerror="this.style.display='none'; this.nextElementSibling.style.display='inline'">
                <span style="display:none;">🎈</span> <span id="user-bp">0</span>
            </div>
        </div>
    </header>

    <main id="screen-main" class="screen active">
        <div class="main-logo">
            <h1 class="soop-text-logo" style="font-size: 60px; margin-bottom: 10px;">SOOP</h1>
            <h1 style="font-size: 32px; color: #333;">버츄얼 가챠</h1>
        </div>
        <nav class="menu-grid">
            <button class="menu-btn primary" onclick="goScreen('gacha')"><span style="font-size:24px;">✨</span><span>가챠 뽑기</span></button>
            <button class="menu-btn primary" onclick="goScreen('minigame')"><span style="font-size:24px;">🎮</span><span>미니게임</span></button>
            <button class="menu-btn" onclick="goScreen('shop')"><span style="font-size:20px;">🛒</span><span>상점</span></button>
            <button class="menu-btn" onclick="goScreen('achievements')"><span style="font-size:20px;">🏆</span><span>도전과제</span></button>
            <button class="menu-btn" onclick="goScreen('pokedex')"><span style="font-size:20px;">📖</span><span>도감</span></button>
            <button class="menu-btn" onclick="goScreen('mycrew')"><span style="font-size:20px;">🤝</span><span>나만의 크루</span></button>
            <button class="menu-btn sub" onclick="openSettings()"><span>⚙️ 설정</span></button>
            <button class="menu-btn sub" onclick="goScreen('tutorial')"><span>❓ 튜토리얼</span></button>
        </nav>
       <div class="notice-box">
            <h3>📢 공지사항</h3>
            <ul>
                <li><strong>UI 업데이트</strong>: 로고와 코인 아이콘이 깔끔하게 변경되었습니다.</li>
                <li><strong>s226 양도끼</strong>: 1성 → 2성 → 22성 (무지개) 진화!</li>
                <li><strong>미니게임</strong>: 난이도 하향 & 스페이스바 점프 가능</li>
                <li style="margin-top: 10px; font-weight: bold; color: #555;">📧 제작자: konamp63@gmail.com</li>
            </ul>
        </div>
    </main>

    <section id="screen-gacha" class="screen">
        <h2>✨ 버츄얼 가챠</h2>
        <div class="gacha-promo-card">
            <div class="promo-text"><h3 id="gacha-event-title">픽업 이벤트</h3></div>
            <div class="promo-banner" id="promo-banner-container">
                <img id="gacha-banner-img" src="" onerror="this.style.display='none'; document.getElementById('gacha-fallback-logo').style.display='block';">
                <div id="gacha-fallback-logo" style="display:none; padding: 40px 0;">
                    <span class="soop-text-logo" style="font-size: 50px;">SOOP</span>
                </div>
            </div>
            <div class="promo-action">
                <button class="action-btn" onclick="pullGacha()">💎 6회 뽑기 (6코인)</button>
                <p class="promo-desc">* 1회(6장) 뽑기 시 별풍선 1개 지급</p>
                <p class="promo-desc">* 5성 중복 시 1코인 환급</p>
            </div>
        </div>
    </section>

    <section id="screen-minigame" class="screen" style="width: 100%; height: 100%; padding: 0;">
        <div id="game-lobby" class="game-container">
            <h2>🎮 버츄얼 런</h2>
            <div class="game-rules-box">
                <h4>📜 게임 규칙 & 효과</h4>
                <ul style="text-align: left; font-size: 13px; color: #555; padding-left: 20px;">
                    <li><strong>기본</strong>: 장애물을 피해 달리세요. (생존 점수)</li>
                    <li><strong>⭐ 등급 효과</strong>: 등급이 높을수록 점수 획득량 증가</li>
                    <li><strong>🛡️ 5성/22성</strong>: 장애물 충돌 <strong>1회 방어</strong></li>
                    <li><strong>🤝 크루 보너스</strong>: 크루 완성 시 동료가 공중에서 지원 사격!</li>
                </ul>
            </div>
            <div class="mode-select-area" style="margin-bottom: 15px;">
                <label style="font-weight:bold; margin-right:10px;">환경 선택:</label>
                <button class="mode-btn" id="btn-mode-mobile" onclick="setGameMode('mobile')">📱 모바일</button>
                <button class="mode-btn active" id="btn-mode-pc" onclick="setGameMode('pc')">💻 PC</button>
            </div>
            <div class="game-char-select" onclick="toggleGameCardSelect()">
                <div class="selected-char-preview" id="game-char-preview"><span style="font-size:24px; color:#ccc;">?</span></div>
                <div class="selected-char-info"><p id="game-char-name">카드 선택</p><p id="game-char-effect" style="font-size:12px; color:#00adef;">터치하여 선택</p></div>
            </div>
            <div id="game-card-list-area" class="game-card-list-area" style="display:none;">
                <input type="text" id="game-search" placeholder="이름 검색" onkeyup="renderGameCardList()">
                <div id="game-card-grid" class="card-grid small-grid"></div>
            </div>
            <div class="game-score-board"><span>최고 점수: <span id="game-best-score">0</span></span></div>
            <div style="display:flex; gap:10px; justify-content:center;">
                <button id="btn-fullscreen-toggle" class="action-btn small" onclick="toggleFullScreen()" style="display:none;">⛶ 전체화면</button>
                <button id="btn-game-start" class="action-btn green" onclick="startGame()">▶ 게임 시작</button>
            </div>
            <p id="game-guide-text" style="font-size:12px; color:#666; margin-top:20px;">PC: 스페이스바 / 모바일: 화면 터치</p>
        </div>
        <div id="game-play-area">
            <canvas id="game-canvas"></canvas>
            <div class="game-hud">
                <div class="hud-item">Score: <span id="game-score">0</span></div>
                <div class="hud-item" id="game-shield-status"></div>
                <button class="hud-quit-btn" onclick="gameOver()">나가기</button>
            </div>
        </div>
    </section>

    <section id="screen-mycrew" class="screen">
        <div class="crew-header-container">
            <div class="crew-logo-display" onclick="openLogoSelect()">
                <img id="my-crew-logo-img" src="" style="display:none;">
                <div id="my-crew-logo-text" class="soop-text-logo" style="font-size: 24px; display:block;">SOOP</div>
            </div>
            <input type="text" id="my-crew-name" class="crew-name-input" placeholder="크루 이름을 입력하세요" onchange="saveCrewName()">
        </div>
        <div class="crew-control-panel" style="flex-direction: column; align-items: center;">
            <div style="display:flex; gap:15px; margin-bottom:10px;">
                <div class="control-item">
                    <label>👥 인원:</label>
                    <select id="crew-size-select" onchange="changeCrewSize(this.value)">
                        <option value="2">2명</option><option value="3">3명</option><option value="4">4명</option><option value="5">5명</option><option value="6">6명</option><option value="7">7명</option><option value="8">8명</option><option value="9">9명</option><option value="10">10명</option><option value="11">11명</option>
                    </select>
                </div>
                <div class="control-item"><label>🎨 직접:</label><input type="color" id="crew-bg-color" value="#ffffff" onchange="changeCrewBgColor()"></div>
            </div>
            <div id="formation-select-area" style="display:none; flex-wrap:wrap; gap:5px; justify-content:center; margin-bottom:10px;">
                <button class="formation-btn" onclick="changeFormation('1-4-4-2')">4-4-2</button><button class="formation-btn" onclick="changeFormation('1-4-3-3')">4-3-3</button><button class="formation-btn" onclick="changeFormation('1-3-4-3')">3-4-3</button><button class="formation-btn" onclick="changeFormation('1-4-2-3-1')">4-2-3-1</button><button class="formation-btn" onclick="changeFormation('1-3-5-2')">3-5-2</button>
            </div>
            <div class="crew-palette">
                <div class="color-swatch" style="background:#ffffff; border:1px solid #ccc;" onclick="setCrewPresetColor('#ffffff')"></div>
                <div class="color-swatch" style="background:#f0f2f5" onclick="setCrewPresetColor('#f0f2f5')"></div>
                <div class="color-swatch" style="background:#00adef" onclick="setCrewPresetColor('#00adef')"></div>
                <div class="color-swatch" style="background:#111111" onclick="setCrewPresetColor('#111111')"></div>
                <div class="color-swatch" style="background:#ffcdd2" onclick="setCrewPresetColor('#ffcdd2')"></div>
                <div class="color-swatch" style="background:#ffe0b2" onclick="setCrewPresetColor('#ffe0b2')"></div>
                <div class="color-swatch" style="background:#fff9c4" onclick="setCrewPresetColor('#fff9c4')"></div>
                <div class="color-swatch" style="background:#c8e6c9" onclick="setCrewPresetColor('#c8e6c9')"></div>
                <div class="color-swatch" style="background:#b3e5fc" onclick="setCrewPresetColor('#b3e5fc')"></div>
                <div class="color-swatch" style="background:#e1bee7" onclick="setCrewPresetColor('#e1bee7')"></div>
            </div>
        </div>
        <div id="my-crew-container" class="crew-bg-container">
            <p class="desc-small" style="margin-top:10px;">슬롯을 눌러 배치 / 마우스를 올려 관리</p>
            <div class="my-crew-slots" id="my-crew-grid"></div>
        </div>
        <div class="crew-actions"><button class="action-btn small" onclick="openLogoSelect()">🛡️ 로고 변경</button><button class="action-btn small red" onclick="resetMyCrew()">🗑️ 초기화</button></div>
    </section>

    <section id="screen-pokedex" class="screen">
        <h2 style="text-align:center; margin-bottom:15px;">📖 도감</h2>
        <div class="tab-menu"><button class="tab-btn active" onclick="renderPokedex('all'); toggleTab(this)">전체 보기</button><button class="tab-btn" onclick="renderPokedex('crew'); toggleTab(this)">그룹/크루별 보기</button></div>
        <div class="controls-area" id="pokedex-controls"></div><div id="pokedex-list" class="card-grid"></div>
    </section>
    <section id="screen-shop" class="screen">
        <h2 style="text-align:center; margin-bottom:15px;">🛒 상점</h2>
        <div class="tab-menu"><button class="tab-btn active" onclick="renderShop('all'); toggleTab(this)">전체 보기</button><button class="tab-btn" onclick="renderShop('crew'); toggleTab(this)">그룹/크루별 보기</button></div>
        <div class="controls-area" id="shop-controls"></div><div id="shop-list" class="card-grid"></div>
    </section>
    <section id="screen-achievements" class="screen">
        <div class="achieve-header center-header"><h2>🏆 도전 과제</h2></div>
        <div style="text-align: right; padding: 0 10px 10px 10px;"><button id="btn-claim-all" class="action-btn small green" style="display:none; margin-left:auto;" onclick="claimAllRewards()">🎁 모두 받기</button></div>
        <div id="achieve-list" class="list-view"></div>
    </section>
    <section id="screen-tutorial" class="screen">
        <h2>❓ 튜토리얼</h2>
        <div class="tutorial-content" style="text-align: left; padding: 20px; background: var(--modal-bg); border-radius: 15px; border: 1px solid #ddd;">
            <p>1. 매일 접속 시 <strong>6코인</strong> 지급</p><p>2. 뽑기 1회당 <strong>별풍선 1개</strong> 적립</p><p>3. <strong>s226 양도끼</strong>는 2성 달성 시 바로 22성이 됩니다.</p><p>4. 5성 카드는 미니게임에서 <strong>충돌을 1회 방어</strong>합니다.</p><p>5. 5성 전용 이미지가 있는 카드는 도감에서 변경 가능합니다.</p>
        </div>
    </section>

    <div id="modal-gacha-result" class="modal"><div class="modal-content"><h3>뽑기 결과</h3><div id="gacha-result-grid" class="card-grid small"></div><p id="gacha-refund-notice" style="color:#e74c3c; font-weight:bold; min-height:20px; margin:15px 0;"></p><div class="gacha-btn-group"><button id="btn-gacha-skip" class="btn-blue" onclick="skipGachaAnimation()">⏩ SKIP</button><button id="btn-gacha-close" class="close-btn" onclick="closeModal('modal-gacha-result')" style="display:none;">확인</button></div></div></div>
    
    <div id="modal-card-detail" class="modal">
        <div class="modal-content card-detail-view" style="display:flex; flex-direction:column; align-items:center;">
            <button class="close-btn-x" onclick="closeModal('modal-card-detail')">×</button>
            <div class="card-item large" id="detail-card-visual" style="margin: 20px auto;">
                <div class="card-inner"><img id="detail-card-img" src="" class="card-img" onclick="openFullImage()"></div>
            </div>
            <button id="btn-swap-img" class="action-btn small" style="display:none; margin-top:15px;" onclick="toggleCardImage()">🔄 일러스트 변경</button>
            <div class="popup-actions" style="margin-top:20px;">
                <button id="btn-go-soop" class="soop-badge-btn" onclick="openSoopChannel()">
                    <span class="soop-text-logo" style="font-size: 18px;">SOOP</span> 
                    <span style="color:#333;">방송국 가기</span>
                </button>
            </div>
        </div>
    </div>

    <div id="modal-evolution" class="modal evolution-overlay" style="display:none;"><div class="evolution-content"><div id="evo-card-container" class="card-wrapper large"></div><h2 id="evo-text" class="evo-text">RANK UP!</h2></div></div>
    <div id="modal-settings" class="modal"><div class="modal-content"><h3>⚙️ 설정</h3><div class="stats-box"><p>총 시도: <span id="stat-pulls">0</span>회 / 사용: <span id="stat-coins">0</span>코인</p><p>수집률: <span id="stat-rate">0</span>%</p></div><button class="btn-blue" id="btn-darkmode" onclick="toggleDarkMode()" style="margin-top:15px;">🌙 다크 모드 켜기</button><hr><h3>💾 데이터 관리</h3><button class="btn-blue" onclick="exportSaveData()">📤 저장 코드 복사</button><button class="btn-green" onclick="importSaveData()">📥 저장 코드 입력</button><button class="btn-red" onclick="resetData()">⚠️ 데이터 초기화</button><button class="close-btn" onclick="closeSettings()">닫기</button></div></div>
    <div id="modal-card-select" class="modal"><div class="modal-content"><h3>멤버 선택</h3><div class="controls-area"><input type="text" id="select-search" placeholder="검색" onkeyup="renderSelectGrid()"></div><div id="select-card-grid" class="card-grid"></div><button class="close-btn" onclick="closeModal('modal-card-select')">취소</button></div></div>
    
    <div id="modal-logo-select" class="modal"><div class="modal-content"><h3>로고 선택</h3><div id="select-logo-grid" class="logo-grid" style="display:flex; flex-wrap:wrap; justify-content:center;"></div><button class="close-btn" onclick="closeModal('modal-logo-select')">취소</button></div></div>
    
    <div id="modal-full-image" class="modal full-view" onclick="closeModal('modal-full-image')"><img id="full-image-src" src=""></div>

    <div class="fixed-email-footer">konamp63@gmail.com</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>
    <script src="data.js"></script>
    <script src="game.js"></script>
    <script src="script.js"></script>
</body>
</html>
